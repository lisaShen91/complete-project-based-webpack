'use strict';

var _dropdown = require('../dropdown');

var _checkbox = require('../checkbox');

var _radio = require('../radio');

var _utils = require('../utils');

module.exports = function (obj, _Vdt, blocks, $callee) {

    _Vdt || (_Vdt = Vdt);
    obj || (obj = {});
    blocks || (blocks = {});
    var h = _Vdt.miss.h,
        hc = _Vdt.miss.hc,
        hu = _Vdt.miss.hu,
        widgets = this && this.widgets || {},
        _blocks = {},
        __blocks = {},
        __u = _Vdt.utils,
        extend = __u.extend,
        _e = __u.error,
        _className = __u.className,
        __o = __u.Options,
        _getModel = __o.getModel,
        _setModel = __o.setModel,
        _setCheckboxModel = __u.setCheckboxModel,
        _detectCheckboxChecked = __u.detectCheckboxChecked,
        _setSelectModel = __u.setSelectModel,
        self = this.data,
        $this = this,
        scope = obj,
        Animate = self && self.Animate,
        parent = ($callee || {})._super;

    var _self$get = self.get(),
        width = _self$get.width,
        title = _self$get.title,
        key = _self$get.key,
        group = _self$get.group,
        multiple = _self$get.multiple,
        sortable = _self$get.sortable,
        $parent = _self$get.$parent,
        _show = _self$get._show;

    var _$parent$get = $parent.get(),
        sort = _$parent$get.sort,
        resizable = _$parent$get.resizable;

    var groupText = group && self._getGroupText() || '';

    return h('th', { 'width': function () {
            try {
                return [width][0];
            } catch (e) {
                _e(e);
            }
        }.call(this), 'title': function () {
            try {
                return [(0, _utils.isStringOrNumber)(title) ? title + groupText : undefined][0];
            } catch (e) {
                _e(e);
            }
        }.call(this), 'ev-click': function () {
            try {
                return [self.onClick][0];
            } catch (e) {
                _e(e);
            }
        }.call(this) }, [function () {
        try {
            return [resizable][0];
        } catch (e) {
            _e(e);
        }
    }.call(this) ? h('div', { 'ev-mousedown': function () {
            try {
                return [self.onDragStart][0];
            } catch (e) {
                _e(e);
            }
        }.call(this), 'ev-click': function () {
            try {
                return [self._stopPropagation][0];
            } catch (e) {
                _e(e);
            }
        }.call(this) }, null, 'k-resize') : undefined, h('div', null, [function () {
        try {
            return [!group][0];
        } catch (e) {
            _e(e);
        }
    }.call(this) ? h('div', null, (_blocks["title"] = function (parent) {
        return function () {
            try {
                return [title][0];
            } catch (e) {
                _e(e);
            }
        }.call(this);
    }) && (__blocks["title"] = function (parent) {
        var self = this;
        return blocks["title"] ? blocks["title"].call(this, function () {
            return _blocks["title"].call(self, parent);
        }) : _blocks["title"].call(this, parent);
    }) && __blocks["title"].call(this), 'c-ellipsis') : undefined, function () {
        try {
            return [group][0];
        } catch (e) {
            _e(e);
        }
    }.call(this) ? h('div', null, [h(_dropdown.Dropdown, { 'children': [h('i', null, null, 'k-arrow ion-ios-arrow-down'), h(_dropdown.DropdownMenu, { 'className': _className(function () {
                try {
                    return [{ 'k-table-dropdown': true, 'k-multiple': multiple }][0];
                } catch (e) {
                    _e(e);
                }
            }.call(this)), 'ev-$change:show': function () {
                try {
                    return [self._onChangeShow][0];
                } catch (e) {
                    _e(e);
                }
            }.call(this), 'children': _Vdt.utils.map(function () {
                try {
                    return [group][0];
                } catch (e) {
                    _e(e);
                }
            }.call(this), function (value, key) {
                return h(_dropdown.DropdownItem, { 'className': _className(function () {
                        try {
                            return [{ 'k-active': self._isChecked(value.value) }][0];
                        } catch (e) {
                            _e(e);
                        }
                    }.call(this)), 'ev-select': function () {
                        try {
                            return [self._onSelect.bind(self, value.value)][0];
                        } catch (e) {
                            _e(e);
                        }
                    }.call(this), 'hideOnSelect': function () {
                        try {
                            return [!multiple][0];
                        } catch (e) {
                            _e(e);
                        }
                    }.call(this), 'children': function () {
                        try {
                            return [multiple][0];
                        } catch (e) {
                            _e(e);
                        }
                    }.call(this) ? h(_checkbox.Checkbox, { 'name': 'key', 'value': function () {
                            try {
                                return [self._isChecked(value.value)][0];
                            } catch (e) {
                                _e(e);
                            }
                        }.call(this), 'children': function () {
                            try {
                                return [value.label][0];
                            } catch (e) {
                                _e(e);
                            }
                        }.call(this), '_context': $this }) : h('span', null, function () {
                        try {
                            return [value.label][0];
                        } catch (e) {
                            _e(e);
                        }
                    }.call(this)), '_context': $this });
            }, this), '_context': $this })], '_context': $this }), h('div', null, [(_blocks["title"] = function (parent) {
        return function () {
            try {
                return [title][0];
            } catch (e) {
                _e(e);
            }
        }.call(this);
    }) && (__blocks["title"] = function (parent) {
        var self = this;
        return blocks["title"] ? blocks["title"].call(this, function () {
            return _blocks["title"].call(self, parent);
        }) : _blocks["title"].call(this, parent);
    }) && __blocks["title"].call(this), '\n                ', function () {
        try {
            return [groupText][0];
        } catch (e) {
            _e(e);
        }
    }.call(this), '\n            '], 'c-ellipsis')], 'k-group') : undefined, '\n        ', function () {
        var _this = this;

        try {
            return [function () {
                if (sortable) {
                    var type = key === sort.key ? sort.type : '';
                    return h('div', null, h('i', null, null, _className(function () {
                        try {
                            var _ref;

                            return [(_ref = {
                                'k-icon': true
                            }, _ref['icon-' + type] = type, _ref['icon-sortable'] = !type, _ref)][0];
                        } catch (e) {
                            _e(e);
                        }
                    }.call(_this))), _className(function () {
                        try {
                            var _ref2;

                            return [(_ref2 = { 'k-sort': true }, _ref2['k-' + type] = type, _ref2)][0];
                        } catch (e) {
                            _e(e);
                        }
                    }.call(_this)));
                }
            }()][0];
        } catch (e) {
            _e(e);
        }
    }.call(this), '\n    '], _className(function () {
        try {
            return [{ "k-th": true, "k-group-show": _show }][0];
        } catch (e) {
            _e(e);
        }
    }.call(this)))], _className(function () {
        try {
            return [{ 'k-sortable': sortable }][0];
        } catch (e) {
            _e(e);
        }
    }.call(this)));
};